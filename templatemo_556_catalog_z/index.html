<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>MovieHouse</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Stylesheet -->
  <link rel="stylesheet" href="css/templatemo-style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <style>
    /* Responsive and modal video fixes */
    .modal {
      display: none;
      position: fixed;
      z-index: 99;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(21, 25, 30, 0.94);
      align-items: center;
      justify-content: center;
      overflow-y: auto;
    }

    #modal-video,
    #tv-episode-player {
      width: 98%;
      aspect-ratio: 16/9;
      min-height: 180px;
      max-height: 46vh;
      margin: 1rem auto 0 auto;
      display: block;
      border-radius: 6px;
      background: #111;
      border: none;
    }

    @media (max-width: 767.98px) {
      #modal-video,
      #tv-episode-player {
        width: 96vw !important;
        height: 54vw !important;
        max-width: 100vw !important;
        min-height: unset !important;
        max-height: 60vw !important;
        aspect-ratio: 16/9 !important;
        margin: 0.5rem auto 0.5rem auto !important;
        display: block;
      }

      .modal-content {
        max-height: 98vh;
        padding: 0.5rem;
      }
    }

    .modal-content {
      background: #222;
      padding: 2rem;
      max-width: 800px;
      width: 100%;
      border-radius: 10px;
      margin: auto;
      position: relative;
      max-height: 98vh;
      overflow-y: auto;
    }

    .modal-body {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      padding: 2rem 2rem 1rem 2rem;
    }

    .modal-body img {
      max-width: 180px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .modal-text {
      min-width: 0;
      flex: 1 1 240px;
    }

    .close {
      position: absolute;
      top: 10px;
      right: 20px;
      color: #fff;
      font-size: 2em;
      cursor: pointer;
      z-index: 100;
    }

    /* Responsive Navbar */
    .navbar {
      background: #15191e;
      color: #fff;
      display: flex;
      align-items: center;
      padding: 0.75rem 1.5rem;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 999;
      width: 100%;
      box-shadow: 0 2px 12px #0002;
    }

    .navbar-brand {
      font-size: 1.7em;
      font-weight: bold;
      letter-spacing: 2px;
      color: #1976d2;
      text-decoration: none;
      display: flex;
      align-items: center;
    }

    .navbar-toggle {
      display: none;
      font-size: 2em;
      background: none;
      border: none;
      color: #fff;
      cursor: pointer;
    }

    .navbar-links {
      display: flex;
      gap: 2rem;
      align-items: center;
    }

    .navbar-links a {
      color: #fff;
      text-decoration: none;
      padding: 0.5em 0.7em;
      border-radius: 3px;
      transition: background 0.2s;
      font-size: 1.05em;
    }

    .navbar-links a:hover,
    .navbar-links a.active {
      background: #1976d2;
      color: #fff;
    }

    @media (max-width: 900px) {
      .navbar-links {
        gap: 1rem;
      }
    }

    @media (max-width: 767.98px) {
      .navbar {
        flex-wrap: wrap;
        padding: 0.75rem 1rem;
      }

      .navbar-toggle {
        display: block;
      }

      .navbar-links {
        flex-direction: column;
        width: 100%;
        padding: 0.5rem 0;
        display: none;
        background: #15191e;
      }

      .navbar-links.show {
        display: flex;
      }

      .navbar-links a {
        width: 90vw;
        text-align: left;
        padding: 0.8em 1em;
        font-size: 1.2em;
      }
    }
  </style>
</head>

<body>
  <!-- Responsive Navbar -->
  <nav class="navbar">
    <a href="#" class="navbar-brand"><i class="fas fa-film" style="margin-right:10px"></i>MovieHouse</a>
    <button class="navbar-toggle" id="nav-toggle" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>
    <div class="navbar-links" id="nav-links">
      <a href="index.html" class="active">Home</a>
      <a href="video-detail.html">Details</a>
      <a href="favorites.html">Favorites</a>
      <a href="contact.html">Contact</a>
    </div>
  </nav>

  <!-- Movie Player Modal -->
  <div class="modal" id="modal">
    <!-- Movie Modal Content -->
    <div class="modal-content" id="modal-content-movie">
      <span class="close" onclick="closeModal()">&times;</span>
      <div class="modal-body">
        <img id="modal-image" src="" alt="Poster" />
        <div class="modal-text">
          <h2 id="modal-title"></h2>
          <div class="stars" id="modal-rating"></div>
          <div class="modal-genre" id="modal-genres"></div>
          <div class="modal-cast" id="modal-cast"></div>
          <div class="modal-crew" id="modal-crew"></div>
          <div class="modal-trailer" id="modal-trailer"></div>
          <p id="modal-description"></p>
          <button class="share-btn" id="share-movie-btn" onclick="shareMovie()">Share</button>
          <div id="similar-movies" style="margin-top: 1.3em;"></div>
        </div>
      </div>
      <div class="server-selector">
        <label for="server">Change Server:</label>
        <select id="server" onchange="changeServer()">
          <option value="vidsrc.cc">Vidsrc.cc</option>
          <option value="vidsrc.me">Vidsrc.me</option>
          <option value="player.videasy.net">Player.Videasy.net</option>
        </select>
      </div>
      <!-- Fixed Movie Player Iframe -->
      <iframe id="modal-video" allowfullscreen></iframe>
    </div>

    <!-- TV Modal Content (hidden unless TV show is shown) -->
    <div class="modal-content" id="modal-content-tv" style="display:none;">
      <span class="close" onclick="closeTvModal()">&times;</span>
      <div class="modal-body">
        <img id="tv-modal-image" src="" alt="Poster" />
        <div class="modal-text">
          <h2 id="tv-modal-title"></h2>
          <div class="modal-genre" id="tv-modal-genres"></div>
          <p id="tv-modal-description"></p>
          <div><strong>First Air Date:</strong> <span id="tv-modal-air-date"></span></div>
          <div><strong>Seasons:</strong> <span id="tv-modal-total-seasons"></span></div>
          <div id="tv-modal-seasons-list"></div>
        </div>
      </div>
      <!-- Fixed TV Player Iframe -->
      <iframe id="tv-episode-player" style="display:none;" allowfullscreen></iframe>
      <button class="tv-episode-next-btn" id="tv-episode-next-btn" style="display:none;">Next Episode</button>
    </div>
  </div>

  <!-- Main Content (Movies/TV shows listing, etc.) -->
  <div id="main-content">
    <!-- Your existing main content goes here -->
    <!-- ... -->
    <div id="movie-list"></div>
    <!-- Loader for infinite scroll -->
    <div id="infinite-loader" style="display:none;text-align:center;margin:2em 0;">
      <i class="fas fa-spinner fa-spin fa-2x"></i>
    </div>
  </div>

  <!-- Footer -->
  <footer style="background:#15191e;color:#fff;padding:1.5em 0 1em 0;text-align:center;">
    <div>
      <ul style="list-style:none;display:flex;justify-content:center;gap:1.5em;margin:0;padding:0;">
        <li><a href="https://facebook.com" style="color:#fff"><i class="fab fa-facebook"></i></a></li>
        <li><a href="https://twitter.com" style="color:#fff"><i class="fab fa-twitter"></i></a></li>
        <li><a href="https://instagram.com" style="color:#fff"><i class="fab fa-instagram"></i></a></li>
      </ul>
      <div style="margin:1em 0 0 0;">
        Copyright 2025 MovieDck Project.
      </div>
    </div>
  </footer>

  <!-- Scripts should be at the end for fast page load -->
  <script src="js/tmdb.js"></script>
  <script>
    // Navbar toggle for mobile
    document.getElementById('nav-toggle').onclick = function () {
      document.getElementById('nav-links').classList.toggle('show');
    };

    // MODAL - MOVIE
    async function showDetails(movie) {
      document.getElementById('modal-content-movie').style.display = '';
      document.getElementById('modal-content-tv').style.display = 'none';
      document.getElementById('modal').style.display = 'flex';
      lastModalMovie = movie;
      addRecentlyViewed(movie);
      document.getElementById('modal-title').textContent = movie.title;
      document.getElementById('modal-description').textContent = movie.overview || '';
      document.getElementById('modal-image').src = movie.poster_path ? imageBaseUrl + movie.poster_path : 'img/no-poster.png';
      document.getElementById('modal-rating').innerHTML = getStars(movie.vote_average || 0) + ` (${movie.vote_average||'N/A'})`;
      document.getElementById('modal-genres').innerHTML = (movie.genre_ids || movie.genres || []).map(gid=>{ /* ... */ }).join(', ');
      // Additional data fetches...
      document.getElementById('server').value = "vidsrc.cc";
      changeServer();
    }

    function changeServer() {
      if (!lastModalMovie) return;
      const server = document.getElementById('server').value;
      const movieId = lastModalMovie.id;
      let embedURL = '';
      if (server === "vidsrc.cc") {
        embedURL = `https://vidsrc.cc/v2/embed/movie/${movieId}`;
      } else if (server === "vidsrc.me") {
        embedURL = `https://vidsrc.net/embed/movie/?tmdb=${movieId}`;
      } else if (server === "player.videasy.net") {
        embedURL = `https://player.videasy.net/movie/${movieId}`;
      }
      document.getElementById('modal-video').src = embedURL;
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
      document.getElementById('modal-video').src = '';
    }

    // MODAL - TV SHOWS
    async function showTvDetails(tv) {
      document.getElementById('modal-content-movie').style.display = 'none';
      document.getElementById('modal-content-tv').style.display = '';
      document.getElementById('modal').style.display = 'flex';
      // Fetch TV details and populate modal...
    }

    function closeTvModal() {
      document.getElementById('modal').style.display = 'none';
      document.getElementById('tv-episode-player').style.display = "none";
      document.getElementById('tv-episode-player').src = "";
      document.getElementById('tv-episode-next-btn').style.display = "none";
    }

    window.playTvEpisode = function(tvId, seasonNum, episodeNum) {
      const iframe = document.getElementById('tv-episode-player');
      iframe.style.display = "";
      iframe.src = `https://vidsrc.cc/v2/embed/tv/${tvId}/${seasonNum}/${episodeNum}`;
      // Show next episode button logic...
    };
  </script>
</body>
</html>
